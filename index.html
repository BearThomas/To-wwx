<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>张真源</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- 引入思源黑体（手机端广泛支持的中文无衬线字体） -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    @keyframes butterflyFly {
      0% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
      100% { transform: translate(var(--end-x), var(--end-y)) rotate(360deg); opacity: 0; }
    }
    
    .butterfly {
      position: fixed;
      width: 40px;
      height: 40px;
      font-size: 36px;
      line-height: 40px;
      text-align: center;
      animation: butterflyFly 3s linear forwards;
      z-index: 9999;
      pointer-events: none;
      user-select: none;
    }
    
    .music-player {
      transition: all 0.3s ease;
    }
    
    .music-player:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    
    .gallery-item {
      transition: all 0.3s ease;
    }
    
    .gallery-item:hover {
      transform: scale(1.03);
    }
    
    .quote-card {
      transition: all 0.3s ease;
    }
    
    .quote-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    
    .countdown-item {
      transition: all 0.3s ease;
    }
    
    .countdown-item:hover {
      transform: scale(1.05);
    }

    /* 手机端优化样式 */
    @media (max-width: 768px) {
      .design-preview {
        min-height: 200px !important;
      }
      
      .design-canvas > * {
        max-width: 90% !important;
      }
    }
  </style>
</head>
<body class="bg-gradient-to-br from-pink-50 to-purple-50 min-h-screen font-sans text-gray-800">
  <!-- 蝴蝶特效容器 -->
  <div id="butterfly-container"></div>
  
  <!-- 导航栏 -->
  <nav class="bg-white shadow-md sticky top-0 z-50">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <h1 class="text-xl font-bold text-pink-600">张真源</h1>
      <div class="flex space-x-2">
        <a href="#photos" class="hover:text-pink-600 transition text-sm">照片</a>
        <a href="#music" class="hover:text-pink-600 transition text-sm">音乐</a>
        <a href="#quotes" class="hover:text-pink-600 transition text-sm">名言</a>
        <a href="#design" class="hover:text-pink-600 transition text-sm">设计</a>
        <a href="#countdown" class="hover:text-pink-600 transition text-sm">倒计时</a>
      </div>
    </div>
  </nav>

  <!-- 主要内容 -->
  <main class="container mx-auto px-4 py-8">
    <!-- 图片设计部分 -->
    <section id="design" class="mb-16">
      <h2 class="text-2xl font-bold text-center mb-6 text-pink-600">张真源图片设计</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="bg-white rounded-xl p-4 shadow-md">
          <h3 class="text-lg font-semibold mb-4">自定义设计</h3>
          <div class="flex flex-col space-y-4">
            <!-- 字体选择改为手机端支持的字体 -->
            <div class="flex items-center">
              <label class="w-16 text-sm">字体:</label>
              <select id="font-family" class="flex-1 px-2 py-1 border rounded-lg text-sm">
                <option value="noto-sans-sc, sans-serif">思源黑体</option>
                <option value="Arial, sans-serif">Arial</option>
                <option value="'Times New Roman', serif">Times New Roman</option>
              </select>
            </div>
            <!-- 其他表单元素 -->
            <div class="flex items-center">
              <label class="w-16 text-sm">名言内容:</label>
              <input id="quote-input" type="text" class="flex-1 px-2 py-1 border rounded-lg text-sm" list="quote-presets" value="机会可从来不会等人，原地踏步久了，就更难迈出下一步。" />
            </div>
          </div>
        </div>
        <div id="design-preview" class="relative bg-pink-100 rounded-xl p-4 shadow-md min-h-48 flex items-center justify-center overflow-hidden" style="min-height:200px;">
          <div id="design-canvas" style="width:100%;height:100%;position:relative;">
            <div id="design-quote" style="position:absolute;left:20px;top:20px;cursor:move;user-select:none;font-size:16px;color:#db2777;font-family:'noto-sans-sc', sans-serif;max-width:90%;">
              "机会可从来不会等人，原地踏步久了，就更难迈出下一步。"<br><span style="font-size:10px;display:block;margin-top:4px;">—— 张真源</span>
            </div>
          </div>
        </div>
      </div>
      <div class="mt-4 text-center">
        <button id="download-design-btn" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition text-sm">下载设计图片</button>
      </div>
    </section>

    <!-- 其他部分代码省略（保持原有结构） -->
  </main>

  <script>
    // 统一事件处理函数（支持鼠标和触摸事件）
    function makeDraggable(el) {
      let isDragging = false, startX, startY, origX, origY;
      
      // 鼠标事件处理
      el.addEventListener('mousedown', function(e) {
        handleDragStart(e);
      });
      
      // 触摸事件处理
      el.addEventListener('touchstart', function(e) {
        handleDragStart(e.touches[0]);
        e.preventDefault(); // 阻止触摸滚动
      });
      
      function handleDragStart(e) {
        isDragging = true;
        startX = e.clientX;
        startY = e.clientY;
        origX = parseInt(el.style.left) || 0;
        origY = parseInt(el.style.top) || 0;
        el.style.zIndex = 10;
        document.body.style.userSelect = 'none';
        
        // 触摸事件时绑定移动和结束事件
        if (e.type === 'touchstart') {
          document.addEventListener('touchmove', handleDragMove);
          document.addEventListener('touchend', handleDragEnd);
        } else {
          document.addEventListener('mousemove', handleDragMove);
          document.addEventListener('mouseup', handleDragEnd);
        }
      }
      
      function handleDragMove(e) {
        if (!isDragging) return;
        const clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
        const clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;
        const dx = clientX - startX;
        const dy = clientY - startY;
        el.style.left = (origX + dx) + 'px';
        el.style.top = (origY + dy) + 'px';
      }
      
      function handleDragEnd() {
        isDragging = false;
        el.style.zIndex = '';
        document.body.style.userSelect = '';
        // 移除触摸事件监听
        document.removeEventListener('touchmove', handleDragMove);
        document.removeEventListener('touchend', handleDragEnd);
        document.removeEventListener('mousemove', handleDragMove);
        document.removeEventListener('mouseup', handleDragEnd);
      }
    }

    // 生成/更新名言时应用字体
    document.getElementById('generate-btn').addEventListener('click', function() {
      const fontFamily = document.getElementById('font-family').value;
      const quoteDiv = document.getElementById('design-quote');
      quoteDiv.style.fontFamily = fontFamily;
      // 其他样式更新...
    });

    // 添加贴纸时应用拖动
    document.getElementById('add-sticker-btn').addEventListener('click', function() {
      const stickerDiv = document.createElement('div');
      // ...创建贴纸元素
      makeDraggable(stickerDiv); // 关键：为新元素添加拖动功能
    });

    // 上传图片时应用拖动
    document.getElementById('upload-img').addEventListener('change', function(e) {
      const img = document.createElement('img');
      // ...创建图片元素
      makeDraggable(img); // 关键：为新图片添加拖动功能
    });

    // 初始化拖动（使用优化后的函数）
    makeDraggable(document.getElementById('design-quote'));
  </script>
</body>
</html>